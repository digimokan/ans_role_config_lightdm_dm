- name: "LightDM: install 'lightdm' package"
  community.general.pacman:
    name: lightdm
    state: present
  become: true
  become_user: root

- name: "Configure auto-login user '{{ auto_login_user_name | default('NONE', true) }}' in {{ lightdm_conf_path }}"
  ansible.builtin.blockinfile:
    path: "{{ lightdm_conf_path }}"
    insertafter: EOF
    block: "autologin-user={{ auto_login_user_name }}"
    marker: "# {mark} ANSIBLE MANAGED BLOCK: auto-login user"
    state: present
  become: true
  become_user: root

- name: "Configure LightDM for automatic login for user '{{ auto_login_user_name }}'"
  ansible.builtin.include_tasks: config_auto_login.yml
  when: (auto_login_user_name)

- name: "Configure LightDM for graphical greeter (disable automatic login)"
  ansible.builtin.include_tasks: config_greeter.yml
  when: not (auto_login_user_name)

